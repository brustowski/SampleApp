// Generated Time: 12/26/2019 16:03:58
// Generated By: IAPetrov

namespace FilingPortal.Parts.Inbond.DataLayer.Migrations
{
    using FilingPortal.Parts.Common.DataLayer.Base;
    using System;
    using System.Data.Entity.Migrations;
    
    public partial class cbdev_2749_add_inbond : FpMigration
    {
        public override void Up()
        {
            CreateTable(
                "inbond.inbound",
                c => new
                    {
                        id = c.Int(nullable: false, identity: true),
                        firms_code_id = c.Int(nullable: false),
                        importer_id = c.Guid(nullable: false),
                        port_of_arrival = c.String(maxLength: 128, unicode: false),
                        entry_date = c.DateTime(),
                        conveyance = c.String(maxLength: 128, unicode: false),
                        consignee_id = c.Guid(nullable: false),
                        value = c.Decimal(precision: 18, scale: 6),
                        manifest_qty = c.Decimal(precision: 18, scale: 6),
                        manifest_qty_unit = c.String(maxLength: 128, unicode: false),
                        weight = c.Decimal(precision: 18, scale: 6),
                        description = c.String(maxLength: 128, unicode: false),
                        marks_and_numbers = c.String(maxLength: 128, unicode: false),
                        created_date = c.DateTime(nullable: false),
                        created_user = c.String(maxLength: 128, unicode: false),
                        deleted = c.Boolean(nullable: false),
                    })
                .PrimaryKey(t => t.id)
                .ForeignKey("dbo.Clients", t => t.consignee_id, cascadeDelete: true)
                .ForeignKey("dbo.cw_firms_codes", t => t.firms_code_id, cascadeDelete: true)
                .ForeignKey("dbo.Clients", t => t.importer_id)
                .Index(t => t.firms_code_id)
                .Index(t => t.importer_id)
                .Index(t => t.consignee_id);
            
            CreateTable(
                "inbond.filing_header",
                c => new
                    {
                        id = c.Int(nullable: false, identity: true),
                        mapping_status = c.Byte(),
                        filing_status = c.Byte(),
                        created_date = c.DateTime(nullable: false),
                        created_user = c.String(nullable: false, maxLength: 128, unicode: false),
                        filing_number = c.String(maxLength: 255, unicode: false),
                        job_link = c.String(maxLength: 128, unicode: false),
                    })
                .PrimaryKey(t => t.id);
            
            CreateTable(
                "inbond.documents",
                c => new
                    {
                        id = c.Int(nullable: false, identity: true),
                        created_date = c.DateTime(nullable: false),
                        created_user = c.String(nullable: false, maxLength: 128, unicode: false),
                        document_type = c.String(maxLength: 128, unicode: false),
                        description = c.String(maxLength: 1000, unicode: false),
                        extension = c.String(nullable: false, maxLength: 128, unicode: false),
                        file_name = c.String(nullable: false, maxLength: 255, unicode: false),
                        filing_header_id = c.Int(nullable: false),
                        inbound_record_id = c.Int(),
                    })
                .PrimaryKey(t => t.id)
                .ForeignKey("inbond.filing_header", t => t.filing_header_id, cascadeDelete: true)
                .Index(t => t.filing_header_id);
            
            CreateTable(
                "inbond.form_section_configuration",
                c => new
                    {
                        id = c.Int(nullable: false, identity: true),
                        name = c.String(nullable: false, maxLength: 128, unicode: false),
                        title = c.String(nullable: false, maxLength: 128, unicode: false),
                        table_name = c.String(maxLength: 128, unicode: false),
                        procedure_name = c.String(maxLength: 128, unicode: false),
                        is_array = c.Boolean(nullable: false),
                        is_hidden = c.Boolean(nullable: false),
                        parent_id = c.Int(),
                    })
                .PrimaryKey(t => t.id)
                .ForeignKey("inbond.form_section_configuration", t => t.parent_id)
                .Index(t => t.name, unique: true)
                .Index(t => t.parent_id);
            
            CreateTable(
                "inbond.form_configuration",
                c => new
                    {
                        id = c.Int(nullable: false, identity: true),
                        section_id = c.Int(nullable: false),
                        has_default_value = c.Boolean(nullable: false),
                        editable = c.Boolean(nullable: false),
                        mandatory = c.Boolean(nullable: false),
                        column_name = c.String(nullable: false, maxLength: 128, unicode: false),
                        created_date = c.DateTime(nullable: false),
                        created_user = c.String(nullable: false, maxLength: 128, unicode: false),
                        value = c.String(maxLength: 512, unicode: false),
                        display_on_ui = c.Byte(nullable: false),
                        manual = c.Byte(nullable: false),
                        single_filing_order = c.Byte(),
                        description = c.String(maxLength: 128, unicode: false),
                        label = c.String(nullable: false, maxLength: 128, unicode: false),
                        paired_field_table = c.String(maxLength: 128, unicode: false),
                        paired_field_column = c.String(maxLength: 128, unicode: false),
                        handbook_name = c.String(maxLength: 128, unicode: false),
                    })
                .PrimaryKey(t => t.id)
                .ForeignKey("inbond.form_section_configuration", t => t.section_id)
                .Index(t => t.section_id);
            
            CreateTable(
                "inbond.filing_detail",
                c => new
                    {
                        Filing_Headers_FK = c.Int(nullable: false),
                        Z_FK = c.Int(nullable: false),
                    })
                .PrimaryKey(t => new { t.Filing_Headers_FK, t.Z_FK })
                .ForeignKey("inbond.filing_header", t => t.Filing_Headers_FK, cascadeDelete: true)
                .ForeignKey("inbond.inbound", t => t.Z_FK, cascadeDelete: true)
                .Index(t => t.Filing_Headers_FK)
                .Index(t => t.Z_FK);
            
            ExecuteSqlFileUp();
        }
        
        public override void Down()
        {
            DropForeignKey("inbond.form_section_configuration", "parent_id", "inbond.form_section_configuration");
            DropForeignKey("inbond.form_configuration", "section_id", "inbond.form_section_configuration");
            DropForeignKey("inbond.inbound", "importer_id", "dbo.Clients");
            DropForeignKey("inbond.inbound", "firms_code_id", "dbo.cw_firms_codes");
            DropForeignKey("inbond.filing_detail", "Z_FK", "inbond.inbound");
            DropForeignKey("inbond.filing_detail", "Filing_Headers_FK", "inbond.filing_header");
            DropForeignKey("inbond.documents", "filing_header_id", "inbond.filing_header");
            DropForeignKey("inbond.inbound", "consignee_id", "dbo.Clients");
            DropIndex("inbond.filing_detail", new[] { "Z_FK" });
            DropIndex("inbond.filing_detail", new[] { "Filing_Headers_FK" });
            DropIndex("inbond.form_configuration", new[] { "section_id" });
            DropIndex("inbond.form_section_configuration", new[] { "parent_id" });
            DropIndex("inbond.form_section_configuration", new[] { "name" });
            DropIndex("inbond.documents", new[] { "filing_header_id" });
            DropIndex("inbond.inbound", new[] { "consignee_id" });
            DropIndex("inbond.inbound", new[] { "importer_id" });
            DropIndex("inbond.inbound", new[] { "firms_code_id" });
            DropTable("inbond.filing_detail");
            DropTable("inbond.form_configuration");
            DropTable("inbond.form_section_configuration");
            DropTable("inbond.documents");
            DropTable("inbond.filing_header");
            DropTable("inbond.inbound");

            ExecuteSqlFileDown();
        }
    }
}

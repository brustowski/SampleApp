// Generated Time: 11/07/2019 15:13:12
// Generated By: IAPetrov

using FilingPortal.Parts.Common.DataLayer.Base;

namespace FilingPortal.DataLayer.Migrations
{

    public partial class cbdev_2765_create_database_structure_for_train_consist_sheet : FpMigration
    {
        public override void Up()
        {
            DropForeignKey("dbo.App_Users_Roles", "App_Users_FK", "dbo.app_users");
            DropForeignKey("dbo.Vessel_Imports", "user_id", "dbo.app_users");
            DropForeignKey("dbo.app_users_data", "UserAccount", "dbo.app_users");
            DropIndex("dbo.Vessel_Imports", new[] { "user_id" });
            DropIndex("dbo.App_Users_Roles", new[] { "App_Users_FK" });
            DropPrimaryKey("dbo.app_users");
            DropPrimaryKey("dbo.app_users_data");
            DropPrimaryKey("dbo.App_Users_Roles");
            CreateTable(
                "dbo.imp_rail_audit_train_consist_sheet",
                c => new
                {
                    id = c.Int(nullable: false, identity: true),
                    trip_id = c.String(maxLength: 128, unicode: false),
                    train_no = c.String(maxLength: 128, unicode: false),
                    entry_number = c.String(maxLength: 128, unicode: false),
                    bill_number = c.String(maxLength: 128, unicode: false),
                    status = c.String(maxLength: 128, unicode: false),
                    created_date = c.DateTime(nullable: false),
                    created_user = c.String(nullable: false, maxLength: 128, unicode: false),
                })
                .PrimaryKey(t => t.id)
                .ForeignKey("dbo.app_users", t => t.created_user, cascadeDelete: true)
                .Index(t => t.created_user);

            AlterColumn("dbo.app_users", "UserAccount", c => c.String(nullable: false, maxLength: 128, unicode: false));
            AlterColumn("dbo.Vessel_Imports", "user_id", c => c.String(nullable: false, maxLength: 128, unicode: false));
            AlterColumn("dbo.app_users_data", "UserAccount", c => c.String(nullable: false, maxLength: 128, unicode: false));
            AlterColumn("dbo.App_Users_Roles", "App_Users_FK", c => c.String(nullable: false, maxLength: 128, unicode: false));
            AddPrimaryKey("dbo.app_users", "UserAccount");
            AddPrimaryKey("dbo.app_users_data", "UserAccount");
            AddPrimaryKey("dbo.App_Users_Roles", new[] { "App_Users_FK", "App_Roles_FK" });
            CreateIndex("dbo.Vessel_Imports", "user_id");
            CreateIndex("dbo.App_Users_Roles", "App_Users_FK");
            AddForeignKey("dbo.App_Users_Roles", "App_Users_FK", "dbo.app_users", "UserAccount", cascadeDelete: true);
            AddForeignKey("dbo.Vessel_Imports", "user_id", "dbo.app_users", "UserAccount");
            AddForeignKey("dbo.app_users_data", "UserAccount", "dbo.app_users", "UserAccount");

            ExecuteSqlFileUp();
        }

        public override void Down()
        {
            DropForeignKey("dbo.Vessel_Imports", "user_id", "dbo.app_users");
            DropForeignKey("dbo.App_Users_Roles", "App_Users_FK", "dbo.app_users");
            DropForeignKey("dbo.imp_rail_audit_train_consist_sheet", "created_user", "dbo.app_users");
            DropForeignKey("dbo.app_users_data", "UserAccount", "dbo.app_users");
            DropIndex("dbo.App_Users_Roles", new[] { "App_Users_FK" });
            DropIndex("dbo.Vessel_Imports", new[] { "user_id" });
            DropIndex("dbo.imp_rail_audit_train_consist_sheet", new[] { "created_user" });
            DropPrimaryKey("dbo.App_Users_Roles");
            DropPrimaryKey("dbo.app_users_data");
            DropPrimaryKey("dbo.app_users");
            AlterColumn("dbo.App_Users_Roles", "App_Users_FK", c => c.String(nullable: false, maxLength: 255));
            AlterColumn("dbo.app_users_data", "UserAccount", c => c.String(nullable: false, maxLength: 255));
            AlterColumn("dbo.Vessel_Imports", "user_id", c => c.String(nullable: false, maxLength: 255));
            AlterColumn("dbo.app_users", "UserAccount", c => c.String(nullable: false, maxLength: 255));
            DropTable("dbo.imp_rail_audit_train_consist_sheet");
            AddPrimaryKey("dbo.App_Users_Roles", new[] { "App_Users_FK", "App_Roles_FK" });
            AddPrimaryKey("dbo.app_users_data", "UserAccount");
            AddPrimaryKey("dbo.app_users", "UserAccount");
            CreateIndex("dbo.App_Users_Roles", "App_Users_FK");
            CreateIndex("dbo.Vessel_Imports", "user_id");
            AddForeignKey("dbo.Vessel_Imports", "user_id", "dbo.app_users", "UserAccount");
            AddForeignKey("dbo.App_Users_Roles", "App_Users_FK", "dbo.app_users", "UserAccount", cascadeDelete: true);
            AddForeignKey("dbo.app_users_data", "UserAccount", "dbo.app_users", "UserAccount");

            ExecuteSqlFileDown();
        }
    }
}
